created virtual environment CPython3.9.6.final.0-64 in 4433ms
  creator CPython3Posix(dest=/localscratch/src.8406134.0/env, clear=False, global=False)
  seeder FromAppData(download=False, pip=latest, setuptools=latest, wheel=latest, via=copy, app_data_dir=/home/src/.local/share/virtualenv/seed-app-data/v1.0.1)
  activators BashActivator,CShellActivator,FishActivator,PowerShellActivator,PythonActivator,XonshActivator
Ignoring pip: markers 'python_version < "3"' don't match your environment
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pip-23.0+computecanada-py3-none-any.whl
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 20.0.2
    Uninstalling pip-20.0.2:
      Successfully uninstalled pip-20.0.2
Successfully installed pip-23.0+computecanada
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2/torch-2.0.1+computecanada-cp39-cp39-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/filelock-3.12.0+computecanada-py3-none-any.whl
Requirement already satisfied: sympy in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from torch) (1.11.1+computecanada)
Requirement already satisfied: typing-extensions in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from torch) (4.5.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/networkx-3.1+computecanada-py3-none-any.whl
Requirement already satisfied: jinja2 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from torch) (3.1.2+computecanada)
Requirement already satisfied: MarkupSafe>=2.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from jinja2->torch) (2.1.2+computecanada)
Requirement already satisfied: mpmath>=0.19 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from sympy->torch) (1.2.1+computecanada)
Installing collected packages: networkx, filelock, torch
Successfully installed filelock-3.12.0+computecanada networkx-3.1+computecanada torch-2.0.1+computecanada
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/nltk-3.8.1+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tqdm-4.65.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/click-8.1.6+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/joblib-1.3.1+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/regex-2022.10.31+computecanada-cp39-cp39-linux_x86_64.whl
Installing collected packages: tqdm, regex, joblib, click, nltk
Successfully installed click-8.1.6+computecanada joblib-1.3.1+computecanada nltk-3.8.1+computecanada regex-2022.10.31+computecanada tqdm-4.65.0+computecanada
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tensorboard-2.13.0+computecanada-py3-none-any.whl
Requirement already satisfied: wheel>=0.26 in /localscratch/src.8406134.0/env/lib/python3.9/site-packages (from tensorboard) (0.34.2)
Requirement already satisfied: requests<3,>=2.21.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from tensorboard) (2.28.2+computecanada)
Requirement already satisfied: numpy>=1.12.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from tensorboard) (1.24.2+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2/protobuf-4.22.2+computecanada-cp39-cp39-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_auth-2.21.0+computecanada-py2.py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic/grpcio-1.51.3+computecanada-cp39-cp39-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_auth_oauthlib-1.0.0+computecanada-py2.py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/absl_py-1.4.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/Markdown-3.4.3+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tensorboard_data_server-0.7.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/Werkzeug-2.3.6+computecanada-py3-none-any.whl
Requirement already satisfied: setuptools>=41.0.0 in /localscratch/src.8406134.0/env/lib/python3.9/site-packages (from tensorboard) (46.1.3)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyasn1_modules-0.3.0+computecanada-py2.py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/cachetools-5.3.1+computecanada-py3-none-any.whl
Requirement already satisfied: urllib3<2.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard) (1.26.14+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/rsa-4.9+computecanada-py3-none-any.whl
Requirement already satisfied: six>=1.9.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/ipykernel/2023a/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard) (1.16.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests_oauthlib-1.3.1+computecanada-py2.py3-none-any.whl
Requirement already satisfied: importlib-metadata>=4.4 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/ipykernel/2023a/lib/python3.9/site-packages (from markdown>=2.6.8->tensorboard) (5.2.0+computecanada)
Requirement already satisfied: idna<4,>=2.5 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from requests<3,>=2.21.0->tensorboard) (3.4+computecanada)
Requirement already satisfied: certifi>=2017.4.17 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from requests<3,>=2.21.0->tensorboard) (2022.12.7+computecanada)
Requirement already satisfied: charset-normalizer<4,>=2 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from requests<3,>=2.21.0->tensorboard) (3.0.1+computecanada)
Requirement already satisfied: MarkupSafe>=2.1.1 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2023a/lib/python3.9/site-packages (from werkzeug>=1.0.1->tensorboard) (2.1.2+computecanada)
Requirement already satisfied: zipp>=0.5 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/ipykernel/2023a/lib/python3.9/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard) (3.14.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyasn1-0.5.0+computecanada-py2.py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/oauthlib-3.2.2+computecanada-py3-none-any.whl
Installing collected packages: werkzeug, tensorboard-data-server, pyasn1, protobuf, oauthlib, grpcio, cachetools, absl-py, rsa, requests-oauthlib, pyasn1-modules, markdown, google-auth, google-auth-oauthlib, tensorboard
Successfully installed absl-py-1.4.0+computecanada cachetools-5.3.1+computecanada google-auth-2.21.0+computecanada google-auth-oauthlib-1.0.0+computecanada grpcio-1.51.3+computecanada markdown-3.4.3+computecanada oauthlib-3.2.2+computecanada protobuf-4.22.2+computecanada pyasn1-0.5.0+computecanada pyasn1-modules-0.3.0+computecanada requests-oauthlib-1.3.1+computecanada rsa-4.9+computecanada tensorboard-2.13.0+computecanada tensorboard-data-server-0.7.0+computecanada werkzeug-2.3.6+computecanada
mkdir: cannot create directory ‘IncrementalReadingLanguageModelling/src/language_models/transformer/parameters/’: File exists
INFO:root:data_loc: IncrementalReadingLanguageModelling/data/wiki/sequences/word/transformer/
INFO:root:results_loc: IncrementalReadingLanguageModelling/src/language_models/transformer/parameters/
INFO:root:dict_loc: IncrementalReadingLanguageModelling/data/wiki/sequences/word/transformer/wiki_train_word_indices
INFO:root:batch_size: 5
INFO:root:lr: 0.005
INFO:root:n_epochs: 8
INFO:root:model_ids: [1]
INFO:root:cuda: True
INFO:root:save_states: [1000, 3000, 10000, 30000, 100000, 300000, 1000000, 3000000, 5855670]
INFO:root:gradient_clipping: False
INFO:root:seed: 745546129
INFO:root:param: xavier
INFO:root:bias: none
INFO:root:Use CUDA: True
INFO:encoders:Using the standard transformer encoder but with decoder (future) masking
INFO:encoders:Embedding layer: {'n_embeddings': 61478, 'embedding_dim': 96, 'sparse': False, 'padding_idx': 0}
Transformer layer: {'in_size': 96, 'fc_size': 256, 'n_layers': 1, 'h': 8, 'max_len': 54}
INFO:nwp_trainer:SGD (
Parameter Group 0
    dampening: 0
    differentiable: False
    foreach: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    momentum: 0.9
    nesterov: False
    weight_decay: 0
)
INFO:nwp_trainer:<torch.optim.lr_scheduler.MultiStepLR object at 0x2aca75fb8610>
INFO:root:Training model nr 1
INFO:root:Model parameters: 11952006
INFO:nwp_trainer:training epoch: 1
INFO:nwp_trainer:Loss after 1000 sentences: 8.640148315429688
Training time: 0.9335167407989502
INFO:nwp_trainer:Loss after 3000 sentences: 7.8502408854166665
Training time: 2.8330187797546387
INFO:nwp_trainer:Loss after 10000 sentences: 7.1300361328125
Training time: 9.290281772613525
INFO:nwp_trainer:Loss after 30000 sentences: 6.625929036458333
Training time: 27.4063663482666
INFO:nwp_trainer:training epoch: 2
INFO:nwp_trainer:training epoch: 3
INFO:nwp_trainer:training epoch: 4
INFO:nwp_trainer:training epoch: 5
INFO:nwp_trainer:training epoch: 6
INFO:nwp_trainer:training epoch: 7
INFO:nwp_trainer:training epoch: 8
Epoch 1 of 8 took 3.379s
training loss:		11.012619
validation loss:		11.011331
Epoch 1 of 8 took 32.173s
training loss:		5.824954
validation loss:		5.745558
Epoch 2 of 8 took 32.425s
training loss:		5.496913
validation loss:		5.513425
Epoch 3 of 8 took 33.196s
training loss:		5.348488
validation loss:		5.448724
Epoch 4 of 8 took 32.620s
training loss:		5.218706
validation loss:		5.387340
Epoch 5 of 8 took 32.420s
training loss:		5.142989
validation loss:		5.362053
Epoch 6 of 8 took 32.414s
training loss:		5.088785
validation loss:		5.349898
Epoch 7 of 8 took 32.299s
training loss:		5.052438
validation loss:		5.336601
Epoch 8 of 8 took 32.720s
training loss:		5.020806
validation loss:		5.326653
